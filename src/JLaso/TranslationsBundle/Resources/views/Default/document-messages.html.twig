<div class="translations-group row-fluid" id="key-{{ translation.id }}">

    <div class="span12">
        <div class="row-fluid">
            <div style="text-align: left;" class="span12 btn">
                <i class="icon-list"></i> {{ translation.key }} &nbsp;<i class="icon-comment"></i> <span id="comment_{{ translation.id }}">{{ translation.comment }}</span>
            </div>
        </div>
        <div class="row-fluid" style="background-color: #ffffff;">
            <table cellpadding="0" cellspacing="0" border="0"
                   class="table table-striped table-bordered" id="example">
                <thead>
                <tr>
                    <th>{{ "label.language"|trans|raw }}</th>
                    <th>{{ "label.message"|trans|raw }}</th>
                    <th>{{ "label.actions"|trans|raw }}</th>
                </tr>
                </thead>
                <tbody>
                <tr id="comment-{{ translation.id }}" class="comment-row">
                    <td><i class="icon-comment"></i>&nbsp;{{ "label.comment"|trans|raw }}</td>
                    {% set canComment = permission(permissions, 'comment', 'WRITE') %}
                    {% if canComment %}
                        <td><input type="text" class="span12" value="{{ translation.comment }}"/></td>
                        <td>
                            <a href="#" class="btn btn-primary save-comment"
                               data-role="#comment-{{ translation.id }}"
                               tid="{{ translation.id }}" key="{{ translation.key }}">
                                <i class="icon-save"></i> {{ "button.save"|trans|raw }}
                            </a>
                        </td>
                    {% else %}
                        <td>{{ translation.comment }}</td>
                        <td>&nbsp;</td>
                    {% endif %}
                </tr>

                {% for info in translation.files %}

                    {% set locale = info.locale %}
                    {% set info_id = translation.id ~  ':' ~ locale %}
                    {% set info_id_html = keyToHtmlId(info_id) %}

                    {% set canAdmin = permission(permissions, locale, 'ADMIN') %}
                    {% set canEdit  = permission(permissions, locale, 'WRITE') %}
                    {% set canView  = permission(permissions, locale, 'READ') %}
                    {% set approved = info.approved %}

                    {% if canAdmin or canEdit or canView %}
                        <tr class="key-row {{ cycle('odd', 'even') }} gradeX"
                            id="key-{{ translation.id }}-{{ translation.key }}-{{ locale }}">

                            {# ---- label ---- #}
                            <td class="center">
                                <i class="icon-flag"></i>&nbsp;<code>{{ locale }}</code>
                                <img src="{{ asset('bundles/translations/img/flags/' ~ locale ~ '.png') }}" alt="{{ locale }} flag"/>
                                &nbsp;{{ languages[locale].name }}
                                <span class="approved_indicator" key="{{ info_id_html }}">
                                {% if info.approved %}
                                    <i class="icon-thumbs-up"></i>
                                {% else %}
                                    <i class="icon-thumbs-down"></i>
                                {% endif %}
                                </span>
                            </td>

                            {# ---- info ---- #}
                            <td>
                                {% if canEdit %}
                                    <div data-target="#wysiwyg-{{ locale }}" data-role="editor-toolbar" class="btn-toolbar">
                                        <div class="btn-group">
                                            <a title="" data-toggle="dropdown" class="btn dropdown-toggle" data-original-title="Font"><i class="icon-font"></i><b class="caret"></b></a>
                                            <ul class="dropdown-menu">
                                                <li><a style="font-family:'Serif'" data-edit="fontName Serif">Serif</a></li><li><a style="font-family:'Sans'" data-edit="fontName Sans">Sans</a></li><li><a style="font-family:'Arial'" data-edit="fontName Arial">Arial</a></li><li><a style="font-family:'Arial Black'" data-edit="fontName Arial Black">Arial Black</a></li><li><a style="font-family:'Courier'" data-edit="fontName Courier">Courier</a></li><li><a style="font-family:'Courier New'" data-edit="fontName Courier New">Courier New</a></li><li><a style="font-family:'Comic Sans MS'" data-edit="fontName Comic Sans MS">Comic Sans MS</a></li><li><a style="font-family:'Helvetica'" data-edit="fontName Helvetica">Helvetica</a></li><li><a style="font-family:'Impact'" data-edit="fontName Impact">Impact</a></li><li><a style="font-family:'Lucida Grande'" data-edit="fontName Lucida Grande">Lucida Grande</a></li><li><a style="font-family:'Lucida Sans'" data-edit="fontName Lucida Sans">Lucida Sans</a></li><li><a style="font-family:'Tahoma'" data-edit="fontName Tahoma">Tahoma</a></li><li><a style="font-family:'Times'" data-edit="fontName Times">Times</a></li><li><a style="font-family:'Times New Roman'" data-edit="fontName Times New Roman">Times New Roman</a></li><li><a style="font-family:'Verdana'" data-edit="fontName Verdana">Verdana</a></li></ul>
                                        </div>
                                        <div class="btn-group">
                                            <a title="" data-toggle="dropdown" class="btn dropdown-toggle" data-original-title="Font Size"><i class="icon-text-height"></i>&nbsp;<b class="caret"></b></a>
                                            <ul class="dropdown-menu">
                                                <li><a data-edit="fontSize 5"><font size="5">Huge</font></a></li>
                                                <li><a data-edit="fontSize 3"><font size="3">Normal</font></a></li>
                                                <li><a data-edit="fontSize 1"><font size="1">Small</font></a></li>
                                            </ul>
                                        </div>
                                        <div class="btn-group">
                                            <a title="" data-edit="bold" class="btn" data-original-title="Bold (Ctrl/Cmd+B)"><i class="icon-bold"></i></a>
                                            <a title="" data-edit="italic" class="btn" data-original-title="Italic (Ctrl/Cmd+I)"><i class="icon-italic"></i></a>
                                            <a title="" data-edit="strikethrough" class="btn" data-original-title="Strikethrough"><i class="icon-strikethrough"></i></a>
                                            <a title="" data-edit="underline" class="btn" data-original-title="Underline (Ctrl/Cmd+U)"><i class="icon-underline"></i></a>
                                        </div>
                                        <div class="btn-group">
                                            <a title="" data-edit="insertunorderedlist" class="btn" data-original-title="Bullet list"><i class="icon-list-ul"></i></a>
                                            <a title="" data-edit="insertorderedlist" class="btn" data-original-title="Number list"><i class="icon-list-ol"></i></a>
                                            <a title="" data-edit="outdent" class="btn" data-original-title="Reduce indent (Shift+Tab)"><i class="icon-indent-left"></i></a>
                                            <a title="" data-edit="indent" class="btn" data-original-title="Indent (Tab)"><i class="icon-indent-right"></i></a>
                                        </div>
                                        <div class="btn-group">
                                            <a title="" data-edit="justifyleft" class="btn btn-info" data-original-title="Align Left (Ctrl/Cmd+L)"><i class="icon-align-left"></i></a>
                                            <a title="" data-edit="justifycenter" class="btn" data-original-title="Center (Ctrl/Cmd+E)"><i class="icon-align-center"></i></a>
                                            <a title="" data-edit="justifyright" class="btn" data-original-title="Align Right (Ctrl/Cmd+R)"><i class="icon-align-right"></i></a>
                                            <a title="" data-edit="justifyfull" class="btn" data-original-title="Justify (Ctrl/Cmd+J)"><i class="icon-align-justify"></i></a>
                                        </div>
                                        <div class="btn-group">
                                            <a title="" data-toggle="dropdown" class="btn dropdown-toggle" data-original-title="Hyperlink"><i class="icon-link"></i></a>
                                            <div class="dropdown-menu input-append">
                                                <input type="text" data-edit="createLink" placeholder="URL" class="span2">
                                                <button type="button" class="btn">Add</button>
                                            </div>
                                            <a title="" data-edit="unlink" class="btn" data-original-title="Remove Hyperlink"><i class="icon-cut"></i></a>

                                        </div>

                                        <div class="btn-group">
                                            <a id="pictureBtn" title="" class="btn" data-original-title="Insert picture (or just drag &amp; drop)"><i class="icon-picture"></i></a>
                                            <input type="file" data-edit="insertImage" data-target="#pictureBtn" data-role="magic-overlay" style="opacity: 0; position: absolute; top: 0px; left: 0px; width: 41px; height: 30px;">
                                        </div>
                                        <div class="btn-group">
                                            <a title="" data-edit="undo" class="btn" data-original-title="Undo (Ctrl/Cmd+Z)"><i class="icon-undo"></i></a>
                                            <a title="" data-edit="redo" class="btn" data-original-title="Redo (Ctrl/Cmd+Y)"><i class="icon-repeat"></i></a>
                                        </div>
                                        <input type="text" x-webkit-speech="" id="voiceBtn" data-edit="inserttext" style="display: none;">
                                    </div>
                                {% endif %}
                                <span id="wysiwyg-{{ locale }}" class="span12 {{ canEdit ? 'wysiwyg' : '' }}" dir="{{ languages[locale].dir }}">
                                    {{- info.message|raw -}}
                                </span>
                            </td>

                            {# ---- actions ---- #}
                            <td locale="{{ locale }}">

                                {# save button #}
                                {% if canEdit %}
                                    <a href="#" class="btn btn-primary save-message">
                                        <i class="icon-edit"></i> {{ "button.save"|trans|raw }}
                                    </a>
                                {% endif %}

                                {# approve actions #}
                                {% if canAdmin %}
                                    {% if info.approved %}
                                        <a href="#" class="btn btn-danger disapprove">
                                            <i class="icon-thumbs-down"></i> {{ "button.disapprove"|trans|raw }}
                                        </a>
                                    {% else %}
                                        <a href="#" class="btn btn-success approve">
                                            <i class="icon-thumbs-up"></i> {{ "button.approve"|trans|raw }}
                                        </a>
                                    {% endif %}
                                {% endif %}

                            </td>

                        </tr>
                    {% endif %}
                {% endfor %}

                </tbody>
            </table>
        </div>
    </div>
</div><!-- class=translations-group -->